<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ Ø§Ù„Ø«Ø¹Ø¨Ø§Ù† Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ø§Ù„ÙƒÙŠÙˆØª ğŸŠ</title>
<style>
/* -------- CSS -------- */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    touch-action: manipulation;
}

body {
    font-family: 'Courier New', monospace;
    background: #000;
    color: #00ff00;
    height: 100vh;
    overflow: hidden;
    user-select: none;
}

.game-container {
    position: relative;
    width: 100vw;
    height: 100vh;
}

.intro-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: linear-gradient(135deg, #000, #220000);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 30;
    text-align: center;
    padding: 20px;
}

.intro-screen h1 {
    font-size: 48px;
    margin-bottom: 40px;
    color: #ff6b35;
    text-shadow: 0 0 40px #ff6b35;
}

.intro-content p {
    font-size: 22px;
    margin: 15px 0;
    max-width: 80%;
}

.highlight {
    color: #ffdd55;
    font-weight: bold;
    text-shadow: 0 0 15px #ffdd55;
}

.intro-screen button {
    background: #ff6b35;
    color: #fff;
    border: none;
    padding: 20px 50px;
    font-size: 28px;
    font-weight: bold;
    border-radius: 20px;
    cursor: pointer;
    margin-top: 50px;
    box-shadow: 0 0 40px #ff6b35;
    transition: all 0.3s;
}

.intro-screen button:hover {
    transform: scale(1.1);
    box-shadow: 0 0 60px #ff6b35;
}

.score-board {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 10;
    background: rgba(0, 30, 0, 0.6);
    padding: 15px;
    border: 2px solid #00ff00;
    border-radius: 12px;
    box-shadow: 0 0 25px rgba(0, 255, 0, 0.4);
    min-width: 160px;
    backdrop-filter: blur(5px);
}

.score, .high-score {
    font-size: 18px;
    margin: 10px 0;
    text-shadow: 0 0 12px #00ff00;
}

#gameCanvas {
    width: 100vw;
    height: 100vh;
    background: #111;
    display: block;
    border: 5px solid #00ff00;
    box-shadow: 0 0 50px #00ff00;
}

.controls {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
}

button {
    background: rgba(0, 255, 0, 0.7);
    color: #000;
    border: 2px solid #00ff00;
    padding: 12px 24px;
    margin: 0 8px;
    font-size: 16px;
    font-weight: bold;
    border-radius: 10px;
    cursor: pointer;
    box-shadow: 0 0 20px rgba(0, 255, 0, 0.6);
    backdrop-filter: blur(5px);
}

button:hover {
    background: rgba(0, 204, 0, 0.8);
    transform: scale(1.08);
}

.game-over {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.9);
    border: 4px solid #ff0000;
    padding: 40px;
    border-radius: 15px;
    text-align: center;
    box-shadow: 0 0 60px #ff0000;
    z-index: 20;
    backdrop-filter: blur(8px);
}

.game-over h2 {
    color: #ff0000;
    font-size: 28px;
    margin-bottom: 20px;
    text-shadow: 0 0 15px #ff0000;
}
</style>
</head>
<body>
<div class="game-container">
    <div id="introScreen" class="intro-screen">
        <h1>ğŸ Ø§Ù„Ø«Ø¹Ø¨Ø§Ù† Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ø§Ù„ÙƒÙŠÙˆØª ğŸŠ</h1>
        <div class="intro-content">
            <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ØºØ§Ù…Ø±Ø© Ø§Ù„Ø«Ø¹Ø¨Ø§Ù† Ø§Ù„Ù„Ø·ÙŠÙ!</p>
            <p>ÙƒÙ„ Ø§Ù„ØªÙØ§Ø­ Ø¹Ø´Ø§Ù† ØªÙƒØ¨Ø± ÙˆØªØ¬Ù…Ø¹ Ù†Ù‚Ø§Ø· ğŸ¥­</p>
            <p class="highlight">ÙƒÙ„ 20 ØªÙØ§Ø­Ø© â†’ ØªÙˆÙ‡Ø¬ + Ø´ÙƒÙ„ Ø¬Ø¯ÙŠØ¯ + Ù„ÙˆÙ† Ø¬Ø¯ÙŠØ¯!</p>
            <p class="highlight">ÙƒÙ„ 30 ØªÙØ§Ø­Ø© â†’ Ù…ÙØ±Ù‚Ø¹Ø§Øª Ù†Ø§Ø±ÙŠØ© Ù…Ù„ÙˆÙ†Ø© ğŸ†</p>
            <p>Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø³Ù‡Ù… Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø¨Ø§Ù„Ù„Ù…Ø³ Ù„Ù„ØªØ­ÙƒÙ…</p>
        </div>
        <button id="startGameBtn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø©!</button>
    </div>

    <div class="score-board">
        <div class="score">Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="score">0</span></div>
        <div class="high-score">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©: <span id="highScore">0</span></div>
    </div>
    
    <canvas id="gameCanvas"></canvas>
    
    <div class="controls">
        <button id="pauseBtn" style="display:none;">Ø¥ÙŠÙ‚Ø§Ù</button>
        <button id="soundBtn">ğŸ”Š</button>
    </div>
    
    <div id="gameOver" class="game-over" style="display:none;">
        <h2>Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!</h2>
        <p>Ù†ØªÙŠØ¬ØªÙƒ: <span id="finalScore">0</span></p>
        <button id="restartBtn">Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
    </div>

    <!-- Ø£ØµÙˆØ§Øª Ù…Ø¶Ù…Ù†Ø© -->
    <audio id="eatSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSq+0/" type="audio/wav">
    </audio>
    <audio id="growSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRp4CAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSq+0/" type="audio/wav">
    </audio>
    <audio id="crashSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRl4GAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSq+0/" type="audio/wav">
    </audio>
</div>

<script>
// -------- JS --------
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const highScoreEl = document.getElementById('highScore');
const startBtn = document.getElementById('startGameBtn');
const pauseBtn = document.getElementById('pauseBtn');
const soundBtn = document.getElementById('soundBtn');
const introScreen = document.getElementById('introScreen');
const gameOverEl = document.getElementById('gameOver');
const finalScoreEl = document.getElementById('finalScore');
const eatSound = document.getElementById('eatSound');
const growSound = document.getElementById('growSound');
const crashSound = document.getElementById('crashSound');

let soundEnabled = true;
soundBtn.onclick = () => {
    soundEnabled = !soundEnabled;
    soundBtn.textContent = soundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
};

const GRID_SIZE = 35;
let cols, rows;
let snake = [];
let food = {};
let dx = 0;
let dy = 0;
let score = 0;
let applesEaten = 0;
let highScore = localStorage.getItem('snakeHS') || 0;
let gameRunning = false;
let gamePaused = false;
let touchStartX = 0;
let touchStartY = 0;
let glow = false;
let particles = [];

const brightColors = [
    '#ff6b35', '#ffdd55', '#00ffaa', '#66ccff', '#ff99cc', '#aaffff', '#ffaa66', '#ccff66'
];
let currentBodyColor = brightColors[0];
let currentBellyColor = '#ffdd55';

highScoreEl.textContent = highScore;

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    cols = Math.floor(canvas.width / GRID_SIZE);
    rows = Math.floor(canvas.height / GRID_SIZE);
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

function randomFood() {
    do {
        food = {x: Math.floor(Math.random() * cols), y: Math.floor(Math.random() * rows)};
    } while (snake.some(segment => segment.x === food.x && segment.y === food.y));
}

function changeColorAndShape() {
    const randomIndex = Math.floor(Math.random() * brightColors.length);
    currentBodyColor = brightColors[randomIndex];
    currentBellyColor = '#ffffff';
}

function createParticles() {
    for (let i = 0; i < 60; i++) {
        particles.push({
            x: canvas.width / 2 + Math.random() * 200 - 100,
            y: canvas.height / 2 + Math.random() * 200 - 100,
            vx: Math.random() * 12 - 6,
            vy: Math.random() * 12 - 8,
            color: brightColors[Math.floor(Math.random() * brightColors.length)],
            life: 80
        });
    }
}

function updateParticles() {
    particles = particles.filter(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.2;
        p.life--;
        return p.life > 0;
    });
}

function drawParticles() {
    particles.forEach(p => {
        ctx.fillStyle = p.color;
        ctx.globalAlpha = p.life / 80;
        ctx.fillRect(p.x - 5, p.y - 5, 10, 10);
    });
    ctx.globalAlpha = 1;
}

function drawSnake() {
    if (snake.length === 0) return;

    if (glow) {
        ctx.shadowBlur = 60;
        ctx.shadowColor = currentBodyColor;
    }

    ctx.lineWidth = GRID_SIZE * 0.75;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    ctx.strokeStyle = currentBodyColor;
    ctx.beginPath();
    ctx.moveTo(snake[0].x * GRID_SIZE + GRID_SIZE / 2, snake[0].y * GRID_SIZE + GRID_SIZE / 2);
    for (let i = 1; i < snake.length; i++) {
        ctx.lineTo(snake[i].x * GRID_SIZE + GRID_SIZE / 2, snake[i].y * GRID_SIZE + GRID_SIZE / 2);
    }
    ctx.stroke();

    ctx.strokeStyle = currentBellyColor;
    ctx.lineWidth = GRID_SIZE * 0.35;
    ctx.beginPath();
    ctx.moveTo(snake[0].x * GRID_SIZE + GRID_SIZE / 2, snake[0].y * GRID_SIZE + GRID_SIZE / 2);
    for (let i = 1; i < snake.length; i++) {
        ctx.lineTo(snake[i].x * GRID_SIZE + GRID_SIZE / 2, snake[i].y * GRID_SIZE + GRID_SIZE / 2);
    }
    ctx.stroke();

    ctx.shadowBlur = 0;

    const head = snake[0];
    const hx = head.x * GRID_SIZE;
    const hy = head.y * GRID_SIZE;
    const hs = GRID_SIZE;

    ctx.fillStyle = currentBodyColor;
    ctx.beginPath();
    ctx.arc(hx + hs/2, hy + hs/2, hs * 0.45, 0, Math.PI * 2);
    ctx.fill();

    ctx.fillStyle = '#000';
    ctx.beginPath();
    ctx.arc(hx + hs*0.35, hy + hs*0.4, hs*0.13, 0, Math.PI * 2);
    ctx.arc(hx + hs*0.65, hy + hs*0.4, hs*0.13, 0, Math.PI * 2);
    ctx.fill();

    ctx.fillStyle = '#fff';
    ctx.beginPath();
    ctx.arc(hx + hs*0.37, hy + hs*0.37, hs*0.06, 0, Math.PI * 2);
    ctx.arc(hx + hs*0.67, hy + hs*0.37, hs*0.06, 0, Math.PI * 2);
    ctx.fill();

    ctx.strokeStyle = '#000';
    ctx.lineWidth = 4;
    ctx.beginPath();
    ctx.arc(hx + hs/2, hy + hs*0.6, hs*0.22, 0, Math.PI);
    ctx.stroke();

    ctx.fillStyle = '#ff3366';
    ctx.fillRect(hx + hs/2 - 3, hy + hs*0.75, 6, hs*0.2);
}

function drawFood() {
    ctx.fillStyle = '#ff0000';
    ctx.shadowBlur = 30;
    ctx.shadowColor = '#ff0000';
    ctx.beginPath();
    ctx.arc(food.x * GRID_SIZE + GRID_SIZE / 2, food.y * GRID_SIZE + GRID_SIZE / 2, GRID_SIZE / 2 - 6, 0, Math.PI * 2);
    ctx.fill();
    ctx.shadowBlur = 0;
}

function draw() {
    ctx.fillStyle = '#111';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    updateParticles();
    drawParticles();
    drawFood();
    drawSnake();
}

function moveSnake() {
    if (!gameRunning || gamePaused || (dx === 0 && dy === 0)) return;

    const head = {x: snake[0].x + dx, y: snake[0].y + dy};

    if (head.x < 0 || head.x >= cols || head.y < 0 || head.y >= rows) {
        if (soundEnabled) crashSound.currentTime = 0, crashSound.play();
        gameOver();
        return;
    }

    for (let i = 1; i < snake.length; i++) {
        if (head.x === snake[i].x && head.y === snake[i].y) {
            if (soundEnabled) crashSound.currentTime = 0, crashSound.play();
            gameOver();
            return;
        }
    }

    snake.unshift(head);

    if (head.x === food.x && head.y === food.y) {
        if (soundEnabled) eatSound.currentTime = 0, eatSound.play();
        score += 10;
        applesEaten++;
        scoreEl.textContent = score;
        randomFood();

        if (applesEaten % 20 === 0) {
            glow = true;
            changeColorAndShape();
            if (soundEnabled) growSound.currentTime = 0, growSound.play();
            setTimeout(() => { glow = false; }, 3000);
        }

        if (applesEaten % 30 === 0) {
            createParticles();
            if (soundEnabled) growSound.currentTime = 0, growSound.play();
        }
    } else {
        snake.pop();
    }
}

let gameLoop;
function mainLoop() {
    moveSnake();
    draw();
    if (gameRunning && !gamePaused) {
        gameLoop = setTimeout(mainLoop, 150);
    }
}

document.addEventListener('keydown', e => {
    if (!gameRunning || gamePaused) return;
    switch(e.keyCode) {
        case 37: case 65: if (dx !== 1) { dx = -1; dy = 0; } break;
        case 38: case 87: if (dy !== 1) { dx = 0; dy = -1; } break;
        case 39: case 68: if (dx !== -1) { dx = 1; dy = 0; } break;
        case 40: case 83: if (dy !== -1) { dx = 0; dy = 1; } break;
    }
});

canvas.addEventListener('touchstart', e => {
    e.preventDefault();
    touchStartX = e.touches[
